# MAX6675 K-Type Thermocouple Library

This is a versatile library for reading temperature from a MAX6675 K-Type thermocouple amplifier. It provides separate, optimized implementations for the **ESP-IDF** (for ESP32) and **Arduino** (for ATmega328P/Uno, ATmega2560/Mega) frameworks.



---
## Features
-   **Multi-Framework Support:** Clean, separate code for both ESP-IDF and Arduino projects.
-   **Easy Initialization:** Simple setup using any configurable GPIO pins.
-   **Fault Detection:** Automatically detects and reports an open thermocouple connection by returning `NAN`.
-   **Simple Interface:** Provides a single function to get the temperature in degrees Celsius.

---
## Wiring Guide
Connect the MAX6675 module to your microcontroller. The specific pins for SCK, CS, and SO are configurable in your code.

| MAX6675 Pin | Microcontroller Pin | Description                |
|:-------------|:---------------------|:----------------------------|
| **VCC** | 5V / 3.3V            | Power Supply               |
| **GND** | GND                  | Ground                     |
| **SCK** | Any Digital GPIO     | Serial Clock Input         |
| **CS** | Any Digital GPIO     | Chip Select (Active LOW)   |
| **SO** | Any Digital GPIO     | Serial Data Output (MISO)  |

---
## How to Use

The library is structured into two versions. You must use the correct version for your target microcontroller and framework.

### PlatformIO Configuration

In your `platformio.ini` file for each example project, you must point to the correct library folder:

-   **For ESP32 (ESP-IDF):**
    ```ini
    lib_deps =
        ../../lib/max6675_espidf
    ```

-   **For Arduino Uno / Mega:**
    ```ini
    lib_deps =
        ../../lib/max6675_arduino
    ```
<br>

### Usage with ESP-IDF (ESP32)

1.  **Include the library:**
    ```c
    #include "max6675.h"
    ```

2.  **Define your pins using `gpio_num_t`:**
    ```c
    #define MAX_CS_PIN   GPIO_NUM_5
    #define MAX_SCK_PIN  GPIO_NUM_18
    #define MAX_SO_PIN   GPIO_NUM_19
    ```
3.  **Initialize the sensor in `app_main`:**
    ```c
    void app_main(void) {
      // Initialize the sensor with your chosen pins
      max6675_init(MAX_SCK_PIN, MAX_CS_PIN, MAX_SO_PIN);

      while(1) {
          double temp = max6675_read_celsius();
          if (isnan(temp)) {
            printf("Error: Thermocouple is disconnected.\n");
          } else {
            printf("Temperature: %.2f C\n", temp);
          }
          vTaskDelay(pdMS_TO_TICKS(1000));
      }
    }
    ```

<br>

### Usage with Arduino Framework (Uno & Mega)

1.  **Include the library:**
    ```cpp
    #include "max6675.h"
    ```

2.  **Define your pins:**
    ```cpp
    // Example for Arduino Mega
    #define MAX_CS_PIN   53
    #define MAX_SCK_PIN  52
    #define MAX_SO_PIN   50
    ```
3.  **Initialize the sensor in your `setup()` function:**
    ```cpp
    void setup() {
      Serial.begin(9600);
      // Initialize the sensor with your chosen pins
      max6675_init(MAX_SCK_PIN, MAX_CS_PIN, MAX_SO_PIN);
    }
    ```
4.  **Read the temperature in your `loop()`:**
    ```cpp
    void loop() {
      double temp = max6675_read_celsius();

      // The function returns NAN (Not a Number) if the thermocouple is disconnected
      if (isnan(temp)) {
        Serial.println("Error: Thermocouple not connected.");
      } else {
        Serial.print("Temperature: ");
        Serial.print(temp);
        Serial.println(" C");
      }
      delay(1000);
    }
    ```